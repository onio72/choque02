<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Tema 10. Leyes de Newton. Choques (II)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        #simulator {
            position: relative;
            width: 600px;
            height: 200px;
            border: 1px solid black;
            margin: 20px auto;
            background: linear-gradient(to bottom, #ddd, #fff);
        }
        .ball {
            position: absolute;
            bottom: 50px;
            border-radius: 50%;
            text-align: center;
            line-height: 50px;
            font-size: 12px;
            color: white;
        }
        #ball-blue {
            background-color: blue;
        }
        #ball-red {
            background-color: red;
        }
        #controls {
            text-align: center;
            margin: 20px 0;
        }
        table {
            margin: 10px auto;
            border-collapse: collapse;
            width: 50%;
        }
        th, td {
            border: 1px solid black;
            padding: 5px;
            text-align: center;
        }
        .input-box {
            width: 60px;
        }
        .question {
            text-align: left;
            margin: 20px auto;
            width: 50%;
        }
        .question label {
            display: block;
            margin-bottom: 10px;
        }
        .result-ok {
            color: green;
            font-weight: bold;
        }
        .result-ko {
            color: red;
            font-weight: bold;
        }
        footer {
            text-align: center;
            margin-top: 50px;
            font-size: 14px;
        }
        #calculations {
            text-align: center;
        }
    </style>
</head>
<body>

<h1>Tema 10. Leyes de Newton. Choques (II)</h1>

<div id="controls">
    <label for="mass-blue">Masa Bola Azul:</label>
    <input type="range" id="mass-blue" min="1" max="10" value="5">
    <span id="mass-blue-val">5</span> kg

    <label for="mass-red">Masa Bola Roja:</label>
    <input type="range" id="mass-red" min="1" max="10" value="5">
    <span id="mass-red-val">5</span> kg

    <label for="velocity-blue">Velocidad Bola Azul:</label>
    <input type="range" id="velocity-blue" min="1" max="20" value="10">
    <span id="velocity-blue-val">10</span> m/s
</div>

<div id="controls">
    <button onclick="startAnimation()">Animar</button>
    <button onclick="pauseAnimation()">Pausa</button>
    <button onclick="resetAnimation()">Reiniciar</button>
    <button onclick="slowMotion()">Ralentizar</button>
</div>

<div id="simulator">
    <div id="ball-blue" class="ball" style="left: 50px; width: 50px; height: 50px;">10 m/s</div>
    <div id="ball-red" class="ball" style="left: 300px; width: 50px; height: 50px;">0 m/s</div>
</div>

<div id="calculations">
    <p>Realiza los cálculos adecuados redondeando hasta la centésima y completa la tabla. Para comprobar si tus cálculos son correctos pulsa el botón Enviar.</p>
    <table>
        <tr>
            <th></th>
            <th>p<sub>A</sub> (kg.m/s)</th>
            <th>p<sub>R</sub> (kg.m/s)</th>
            <th>p<sub>T</sub> (kg.m/s)</th>
        </tr>
        <tr>
            <td>Antes</td>
            <td><input class="input-box" id="pA-antes"> kg.m/s</td>
            <td><input class="input-box" id="pR-antes"> kg.m/s</td>
            <td><input class="input-box" id="pT-antes"> kg.m/s</td>
        </tr>
        <tr>
            <td>Después</td>
            <td><input class="input-box" id="pA-despues"> kg.m/s</td>
            <td><input class="input-box" id="pR-despues"> kg.m/s</td>
            <td><input class="input-box" id="pT-despues"> kg.m/s</td>
        </tr>
    </table>

    <table>
        <tr>
            <th></th>
            <th>EC<sub>A</sub> (J)</th>
            <th>EC<sub>R</sub> (J)</th>
            <th>EC<sub>T</sub> (J)</th>
        </tr>
        <tr>
            <td>Antes</td>
            <td><input class="input-box" id="ecA-antes"> J</td>
            <td><input class="input-box" id="ecR-antes"> J</td>
            <td><input class="input-box" id="ecT-antes"> J</td>
        </tr>
        <tr>
            <td>Después</td>
            <td><input class="input-box" id="ecA-despues"> J</td>
            <td><input class="input-box" id="ecR-despues"> J</td>
            <td><input class="input-box" id="ecT-despues"> J</td>
        </tr>
    </table>
</div>

<div class="question">
    <p style="font-size: 18px;">Preguntas</p>
    <label>1. El momento lineal de cada bola antes de la colisión es igual al momento lineal de cada bola después de la colisión.
        <select id="q1">
            <option value="">- Sin seleccionar -</option>
            <option value="Verdadero">Verdadero</option>
            <option value="Falso">Falso</option>
        </select>
    </label>
    <label>2. El momento lineal total antes de la colisión es igual al momento lineal total después de la colisión.
        <select id="q2">
            <option value="">- Sin seleccionar -</option>
            <option value="Verdadero">Verdadero</option>
            <option value="Falso">Falso</option>
        </select>
    </label>
    <label>3. La energía cinética de cada bola antes de la colisión es igual a la energía cinética de cada bola después de la colisión.
        <select id="q3">
            <option value="">- Sin seleccionar -</option>
            <option value="Verdadero">Verdadero</option>
            <option value="Falso">Falso</option>
        </select>
    </label>
    <label>4. La energía cinética total antes de la colisión es igual a la energía cinética total después de la colisión.
        <select id="q4">
            <option value="">- Sin seleccionar -</option>
            <option value="Verdadero">Verdadero</option>
            <option value="Falso">Falso</option>
        </select>
    </label>
    <label>5. Este choque es un choque:
        <select id="q5">
            <option value="">- Sin seleccionar -</option>
            <option value="Elástico">Elástico</option>
            <option value="Inelástico">Inelástico</option>
        </select>
    </label>
</div>

<button onclick="checkAnswers()" style="display: block; margin: 20px auto;">Enviar</button>

<footer>
    Antonio González García
</footer>

<script>
    const ballBlue = document.getElementById('ball-blue');
    const ballRed = document.getElementById('ball-red');
    let massBlue = parseFloat(document.getElementById('mass-blue').value);
    let massRed = parseFloat(document.getElementById('mass-red').value);
    let velocityBlue = parseFloat(document.getElementById('velocity-blue').value);
    let animationFrame;
    let slowMotionActive = false;

    document.getElementById('mass-blue').addEventListener('input', function() {
        massBlue = parseFloat(this.value);
        document.getElementById('mass-blue-val').textContent = massBlue;
        updateBallSizes();
    });

    document.getElementById('mass-red').addEventListener('input', function() {
        massRed = parseFloat(this.value);
        document.getElementById('mass-red-val').textContent = massRed;
        updateBallSizes();
    });

    document.getElementById('velocity-blue').addEventListener('input', function() {
        velocityBlue = parseFloat(this.value);
        document.getElementById('velocity-blue-val').textContent = velocityBlue;
        ballBlue.textContent = `${velocityBlue} m/s`;
    });

    function updateBallSizes() {
        const sizeBlue = 50 + (massBlue / 10) * 15;
        const sizeRed = 50 + (massRed / 10) * 15;
        ballBlue.style.width = sizeBlue + 'px';
        ballBlue.style.height = sizeBlue + 'px';
        ballRed.style.width = sizeRed + 'px';
        ballRed.style.height = sizeRed + 'px';
    }

    function startAnimation() {
        ballBlue.textContent = `${velocityBlue} m/s`;
        ballRed.textContent = `0 m/s`;
        let posBlue = 50;
        let posRed = 300;
        const speedBlue = slowMotionActive ? velocityBlue / 10 : velocityBlue;

        function animate() {
            posBlue += speedBlue;
            ballBlue.style.left = posBlue + 'px';

            if (posBlue + parseFloat(ballBlue.style.width) >= posRed) {
                const finalVelocityRed = (2 * massBlue * velocityBlue) / (massBlue + massRed);
                ballRed.textContent = `${finalVelocityRed.toFixed(2)} m/s`;
                ballBlue.textContent = `0 m/s`;

                if (slowMotionActive) {
                    const speedRed = finalVelocityRed / 10;
                    function moveRed() {
                        posRed += speedRed;
                        ballRed.style.left = posRed + 'px';
                        if (posRed < 600) {
                            animationFrame = requestAnimationFrame(moveRed);
                        } else {
                            ballRed.style.transition = 'opacity 0.5s linear';
                            ballRed.style.opacity = 0;
                        }
                    }
                    moveRed();
                } else {
                    ballRed.style.transition = 'left 1s linear, opacity 0.5s linear';
                    ballRed.style.left = '650px';
                    setTimeout(() => {
                        ballRed.style.opacity = 0;
                    }, 1000);
                }
            } else {
                animationFrame = requestAnimationFrame(animate);
            }
        }
        animate();
    }

    function pauseAnimation() {
        cancelAnimationFrame(animationFrame);
    }

    function resetAnimation() {
        cancelAnimationFrame(animationFrame);
        ballBlue.style.left = '50px';
        ballRed.style.left = '300px';
        ballBlue.textContent = `${velocityBlue} m/s`;
        ballRed.textContent = `0 m/s`;
        ballRed.style.transition = 'none';
        ballRed.style.opacity = 1;
    }

    function slowMotion() {
        slowMotionActive = !slowMotionActive;
        resetAnimation();
        startAnimation();
    }

    function checkAnswers() {
        const pA_antes = parseFloat(document.getElementById('pA-antes').value);
        const pR_antes = parseFloat(document.getElementById('pR-antes').value);
        const pT_antes = parseFloat(document.getElementById('pT-antes').value);
        const pA_despues = parseFloat(document.getElementById('pA-despues').value);
        const pR_despues = parseFloat(document.getElementById('pR-despues').value);
        const pT_despues = parseFloat(document.getElementById('pT-despues').value);
        const ecA_antes = parseFloat(document.getElementById('ecA-antes').value);
        const ecR_antes = parseFloat(document.getElementById('ecR-antes').value);
        const ecT_antes = parseFloat(document.getElementById('ecT-antes').value);
        const ecA_despues = parseFloat(document.getElementById('ecA-despues').value);
        const ecR_despues = parseFloat(document.getElementById('ecR-despues').value);
        const ecT_despues = parseFloat(document.getElementById('ecT-despues').value);

        // Check calculations
        const correctP_A_antes = massBlue * velocityBlue;
        const correctP_R_antes = 0;
        const correctP_T_antes = correctP_A_antes + correctP_R_antes;
        const correctP_A_despues = 0;
        const correctP_R_despues = (2 * massBlue * velocityBlue) / (massBlue + massRed) * massRed;
        const correctP_T_despues = correctP_A_despues + correctP_R_despues;

        const correctEC_A_antes = 0.5 * massBlue * Math.pow(velocityBlue, 2);
        const correctEC_R_antes = 0;
        const correctEC_T_antes = correctEC_A_antes + correctEC_R_antes;
        const correctEC_A_despues = 0;
        const correctEC_R_despues = 0.5 * massRed * Math.pow((2 * massBlue * velocityBlue) / (massBlue + massRed), 2);
        const correctEC_T_despues = correctEC_A_despues + correctEC_R_despues;

        validateAnswer('pA-antes', pA_antes, correctP_A_antes);
        validateAnswer('pR-antes', pR_antes, correctP_R_antes);
        validateAnswer('pT-antes', pT_antes, correctP_T_antes);
        validateAnswer('pA-despues', pA_despues, correctP_A_despues);
        validateAnswer('pR-despues', pR_despues, correctP_R_despues);
        validateAnswer('pT-despues', pT_despues, correctP_T_despues);
        validateAnswer('ecA-antes', ecA_antes, correctEC_A_antes);
        validateAnswer('ecR-antes', ecR_antes, correctEC_R_antes);
        validateAnswer('ecT-antes', ecT_antes, correctEC_T_antes);
        validateAnswer('ecA-despues', ecA_despues, correctEC_A_despues);
        validateAnswer('ecR-despues', ecR_despues, correctEC_R_despues);
        validateAnswer('ecT-despues', ecT_despues, correctEC_T_despues);

        validateQuestion('q1', 'Falso');
        validateQuestion('q2', 'Verdadero');
        validateQuestion('q3', 'Falso');
        validateQuestion('q4', 'Verdadero');
        validateQuestion('q5', 'Elástico');
    }

    function validateAnswer(id, givenValue, correctValue) {
        const input = document.getElementById(id);
        if (Math.abs(givenValue - correctValue) < 0.01) {
            input.insertAdjacentHTML('afterend', ' <span class="result-ok">&#10004;</span>');
        } else {
            input.insertAdjacentHTML('afterend', ' <span class="result-ko">&#10008;</span>');
        }
    }

    function validateQuestion(id, correctAnswer) {
        const question = document.getElementById(id);
        const givenAnswer = question.value;
        if (givenAnswer === correctAnswer) {
            question.insertAdjacentHTML('afterend', ' <span class="result-ok">&#10004;</span>');
        } else {
            question.insertAdjacentHTML('afterend', ' <span class="result-ko">&#10008;</span>');
        }
    }
</script>

</body>
</html>
